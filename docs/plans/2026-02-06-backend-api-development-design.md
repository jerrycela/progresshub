# ProgressHub å¾Œç«¯ API é–‹ç™¼è¨­è¨ˆæ–‡ä»¶

**æ—¥æœŸ**: 2026-02-06
**ç‰ˆæœ¬**: 1.0
**ç‹€æ…‹**: å·²é©—è­‰

---

## åŸ·è¡Œæ‘˜è¦

æœ¬è¨­è¨ˆæ–‡ä»¶æè¿° ProgressHub å¾Œç«¯ API çš„é–‹ç™¼è¨ˆç•«ï¼Œæ¡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

- **æ•´åˆç­–ç•¥**ï¼šä¿®æ”¹å¾Œç«¯é…åˆå‰ç«¯å·²å®šç¾©çš„ä»‹é¢
- **é–‹ç™¼é †åº**ï¼šå…ˆä¿®å¾©åŸºç¤è¨­æ–½ï¼Œå†é–‹ç™¼æ–°åŠŸèƒ½
- **é–‹ç™¼ä½ç½®**ï¼š`/packages/backend/`ï¼ˆMonorepo çµæ§‹ï¼‰
- **æ¸¬è©¦ç­–ç•¥**ï¼šTDD + æ•´åˆæ¸¬è©¦
- **éƒ¨ç½²å¹³å°**ï¼šZeabur

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¶æ§‹è¨­è¨ˆ

### ç›®éŒ„çµæ§‹

```
progresshub/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ frontend/          â† Zeabur éƒ¨ç½²ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚   â”œâ”€â”€ backend/           â† Zeabur éƒ¨ç½²ï¼ˆæ–°é–‹ç™¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/    â† API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ services/  â† æ¥­å‹™é‚è¼¯
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/â† èªè­‰ã€éŒ¯èª¤è™•ç†
â”‚   â”‚   â”‚   â””â”€â”€ utils/     â† å·¥å…·å‡½æ•¸
â”‚   â”‚   â”œâ”€â”€ prisma/        â† è³‡æ–™åº« Schema
â”‚   â”‚   â”œâ”€â”€ tests/         â† æ¸¬è©¦æª”æ¡ˆ
â”‚   â”‚   â””â”€â”€ Dockerfile     â† Zeabur éƒ¨ç½²ç”¨
â”‚   â”‚
â”‚   â””â”€â”€ shared/
â”‚       â””â”€â”€ types/         â† å‰å¾Œç«¯å…±ç”¨é¡å‹ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚
â””â”€â”€ docs/                   â† è¨­è¨ˆæ–‡ä»¶ã€API è¦æ ¼
```

### æŠ€è¡“é¸å‹

| é …ç›® | æŠ€è¡“ | åŸå›  |
|-----|-----|------|
| Framework | Express.js | æ²¿ç”¨ç¾æœ‰å¾Œç«¯ç¶“é©— |
| Language | TypeScript | é¡å‹å®‰å…¨ + å…±ç”¨ shared/types |
| ORM | Prisma | æ²¿ç”¨ç¾æœ‰ Schema |
| Database | PostgreSQL | æ²¿ç”¨ç¾æœ‰é¸æ“‡ |
| Auth | JWT + Slack OAuth | æ²¿ç”¨ç¾æœ‰è¨­è¨ˆ |
| Testing | Jest + Supertest | TDD + æ•´åˆæ¸¬è©¦ |

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šAPI å›æ‡‰æ ¼å¼

### çµ±ä¸€å›æ‡‰çµæ§‹

```typescript
// packages/shared/types/api.ts

interface ApiResponse<T> {
  success: boolean
  data?: T
  error?: {
    code: string      // e.g., "TASK_NOT_FOUND", "UNAUTHORIZED"
    message: string   // ä½¿ç”¨è€…å‹å–„è¨Šæ¯
  }
  meta?: {
    total: number     // ç¸½ç­†æ•¸
    page: number      // ç•¶å‰é 
    limit: number     // æ¯é ç­†æ•¸
    hasMore: boolean  // æ˜¯å¦æœ‰ä¸‹ä¸€é 
  }
}
```

### å›æ‡‰ç¯„ä¾‹

**æˆåŠŸ - å–®ä¸€ç‰©ä»¶**
```json
{
  "success": true,
  "data": { "id": "1", "title": "ä»»å‹™æ¨™é¡Œ" }
}
```

**æˆåŠŸ - åˆ—è¡¨ï¼ˆå«åˆ†é ï¼‰**
```json
{
  "success": true,
  "data": [{ "id": "1" }, { "id": "2" }],
  "meta": { "total": 50, "page": 1, "limit": 10, "hasMore": true }
}
```

**éŒ¯èª¤å›æ‡‰**
```json
{
  "success": false,
  "error": { "code": "TASK_NOT_FOUND", "message": "æ‰¾ä¸åˆ°æŒ‡å®šçš„ä»»å‹™" }
}
```

### éŒ¯èª¤ç¢¼è¦ç¯„

| é¡åˆ¥ | å‰ç¶´ | ç¯„ä¾‹ |
|-----|------|------|
| èªè­‰ | AUTH_ | `AUTH_INVALID_TOKEN`, `AUTH_EXPIRED` |
| æ¬Šé™ | PERM_ | `PERM_DENIED`, `PERM_ROLE_REQUIRED` |
| è³‡æº | RESOURCE_ | `RESOURCE_NOT_FOUND`, `RESOURCE_CONFLICT` |
| é©—è­‰ | VALIDATION_ | `VALIDATION_REQUIRED`, `VALIDATION_FORMAT` |
| ä¼ºæœå™¨ | SERVER_ | `SERVER_ERROR`, `SERVER_UNAVAILABLE` |

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šä»»å‹™ç‹€æ…‹è¨­è¨ˆ

### ç‹€æ…‹å®šç¾©ï¼ˆ6 ç¨®ï¼‰

```typescript
// packages/shared/types/task.ts

enum TaskStatus {
  UNCLAIMED = 'UNCLAIMED',       // æœªèªé ˜ï¼ˆä»»å‹™æ± ä¸­ï¼‰
  CLAIMED = 'CLAIMED',           // å·²èªé ˜ï¼ˆå°šæœªé–‹å§‹ï¼‰
  IN_PROGRESS = 'IN_PROGRESS',   // é€²è¡Œä¸­
  PAUSED = 'PAUSED',             // æš«åœä¸­
  BLOCKED = 'BLOCKED',           // å¡é—œ
  DONE = 'DONE'                  // å®Œæˆ
}
```

### ç‹€æ…‹æµè½‰åœ–

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  UNCLAIMED   â”‚ â† æ–°å»ºä»»å‹™é è¨­
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ claim()
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”€â”‚   CLAIMED    â”‚
              â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚            â”‚ start()
              â”‚            â–¼
              â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”Œâ”€â”€â”€â”‚ IN_PROGRESS  â”‚â—„â”€â”€â”€â”
              â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚ â”‚          â”‚            â”‚
    unclaim() â”‚ â”‚ pause()  â”‚ block()    â”‚ resume()
              â”‚ â”‚          â–¼            â”‚ unblock()
              â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
              â”‚ â””â”€â”€â–ºâ”‚   PAUSED     â”‚â”€â”€â”€â”€â”˜
              â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚            â”‚
              â”‚            â–¼
              â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â–ºâ”‚   BLOCKED    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ complete()
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    DONE      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Prisma Schema æ›´æ–°

```prisma
enum TaskStatus {
  UNCLAIMED
  CLAIMED
  IN_PROGRESS
  PAUSED
  BLOCKED
  DONE
}

model Task {
  id          String     @id @default(cuid())
  title       String     // çµ±ä¸€ç”¨ titleï¼ˆåŸ nameï¼‰
  status      TaskStatus @default(UNCLAIMED)
  dueDate     DateTime?  // çµ±ä¸€ç”¨ dueDateï¼ˆåŸ plannedEndDateï¼‰
  progress    Int        @default(0) // çµ±ä¸€ç”¨ progressï¼ˆåŸ progressPercentageï¼‰
  // ...å…¶ä»–æ¬„ä½
}
```

### ä»»å‹™ç‹€æ…‹ API ç«¯é»

| ç«¯é» | æ–¹æ³• | èªªæ˜ |
|-----|------|------|
| `/tasks/:id/claim` | POST | èªé ˜ä»»å‹™ |
| `/tasks/:id/unclaim` | POST | å–æ¶ˆèªé ˜ |
| `/tasks/:id/start` | POST | é–‹å§‹ä»»å‹™ |
| `/tasks/:id/pause` | POST | æš«åœä»»å‹™ |
| `/tasks/:id/resume` | POST | æ¢å¾©ä»»å‹™ |
| `/tasks/:id/block` | POST | æ¨™è¨˜å¡é—œ |
| `/tasks/:id/unblock` | POST | è§£é™¤å¡é—œ |
| `/tasks/:id/complete` | POST | å®Œæˆä»»å‹™ |

---

## ç¬¬å››éƒ¨åˆ†ï¼šå¯¦ä½œéšæ®µè¦åŠƒ

### Phase 1ï¼šåŸºç¤è¨­æ–½ï¼ˆ1 é€±ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 1.1 | å»ºç«‹ `/packages/backend/` å°ˆæ¡ˆçµæ§‹ | å°ˆæ¡ˆéª¨æ¶ã€TypeScript è¨­å®š |
| 1.2 | é·ç§» Prisma Schemaï¼ˆæ›´æ–°ç‹€æ…‹ã€æ¬„ä½åï¼‰ | æ–°ç‰ˆ schema.prisma |
| 1.3 | å¯¦ä½œçµ±ä¸€å›æ‡‰æ ¼å¼ä¸­ä»‹è»Ÿé«” | responseFormatter.ts |
| 1.4 | å¯¦ä½œéŒ¯èª¤è™•ç†ä¸­ä»‹è»Ÿé«” | errorHandler.ts |
| 1.5 | è¨­å®š Jest + Supertest | æ¸¬è©¦åŸºç¤è¨­æ–½ |

### Phase 2ï¼šèªè­‰æ¨¡çµ„ï¼ˆ3 å¤©ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 2.1 | Slack OAuth ç™»å…¥ï¼ˆTDDï¼‰ | `POST /auth/slack` |
| 2.2 | Token é©—è­‰èˆ‡åˆ·æ–°ï¼ˆTDDï¼‰ | `GET /auth/me`, `POST /auth/refresh` |
| 2.3 | ç™»å‡ºåŠŸèƒ½ï¼ˆTDDï¼‰ | `POST /auth/logout` |

### Phase 3ï¼šä»»å‹™ç®¡ç†ï¼ˆ1 é€±ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 3.1 | ä»»å‹™ CRUDï¼ˆTDDï¼‰ | åŸºæœ¬ä»»å‹™æ“ä½œ |
| 3.2 | ä»»å‹™ç‹€æ…‹æµè½‰ï¼ˆTDDï¼‰ | claim/start/pause/complete |
| 3.3 | æˆ‘çš„ä»»å‹™æŸ¥è©¢ï¼ˆTDDï¼‰ | `GET /tasks/my` |

### Phase 4ï¼šç”˜ç‰¹åœ– APIï¼ˆ3 å¤©ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 4.1 | ç”˜ç‰¹åœ–è³‡æ–™èšåˆï¼ˆTDDï¼‰ | `GET /gantt` |
| 4.2 | ç”˜ç‰¹åœ–çµ±è¨ˆï¼ˆTDDï¼‰ | `GET /gantt/stats` |

### Phase 5ï¼šé€²åº¦è¿½è¹¤ï¼ˆ3 å¤©ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 5.1 | é€²åº¦å›å ±ï¼ˆTDDï¼‰ | `POST /progress` |
| 5.2 | æˆ‘çš„é€²åº¦æŸ¥è©¢ï¼ˆTDDï¼‰ | `GET /progress/my` |

### Phase 6ï¼šéƒ¨ç½²èˆ‡æ•´åˆï¼ˆ3 å¤©ï¼‰

| Sprint | ä»»å‹™ | ç”¢å‡º |
|--------|-----|------|
| 6.1 | Dockerfile æ’°å¯« | ç”Ÿç”¢ç’°å¢ƒå»ºç½® |
| 6.2 | Zeabur éƒ¨ç½²è¨­å®š | è‡ªå‹•éƒ¨ç½² |
| 6.3 | å‰ç«¯ API ä¸²æ¥ | ç§»é™¤ Mock è³‡æ–™ |

### ç¸½æ™‚ç¨‹

| Phase | å…§å®¹ | é ä¼°æ™‚é–“ |
|-------|-----|---------|
| 1 | åŸºç¤è¨­æ–½ | 1 é€± |
| 2 | èªè­‰æ¨¡çµ„ | 3 å¤© |
| 3 | ä»»å‹™ç®¡ç† | 1 é€± |
| 4 | ç”˜ç‰¹åœ– API | 3 å¤© |
| 5 | é€²åº¦è¿½è¹¤ | 3 å¤© |
| 6 | éƒ¨ç½²æ•´åˆ | 3 å¤© |
| **ç¸½è¨ˆ** | | **~4 é€±** |

---

## ç¬¬äº”éƒ¨åˆ†ï¼šæ¬„ä½å‘½åå°ç…§

### å‰ç«¯ â†’ å¾Œç«¯çµ±ä¸€

| æ¦‚å¿µ | å‰ç«¯æœŸæœ› | å¾Œç«¯èˆŠå | çµ±ä¸€å¾Œ |
|------|---------|---------|-------|
| ä»»å‹™æ¨™é¡Œ | `title` | `name` | `title` |
| æˆªæ­¢æ—¥æœŸ | `dueDate` | `plannedEndDate` | `dueDate` |
| é€²åº¦ç™¾åˆ†æ¯” | `progress` | `progressPercentage` | `progress` |
| æŒ‡æ´¾äºº | `assigneeId` | `assignedToId` | `assigneeId` |

---

## ç¬¬å…­éƒ¨åˆ†ï¼šå¾…è£œé½Šçš„ API ç«¯é»

| ç«¯é» | æ–¹æ³• | ç”¨é€” | å„ªå…ˆåº¦ |
|-----|------|------|--------|
| `/gantt` | GET | ç”˜ç‰¹åœ–å…¨åŸŸè³‡æ–™ | ğŸ”´ High |
| `/gantt/stats` | GET | ç”˜ç‰¹åœ–çµ±è¨ˆ | ğŸŸ¡ Medium |
| `/progress/my` | GET | æˆ‘çš„é€²åº¦æ—¥èªŒ | ğŸŸ¡ Medium |
| `/auth/refresh` | POST | Token åˆ·æ–° | ğŸ”´ High |
| `/auth/logout` | POST | ç™»å‡º | ğŸŸ¡ Medium |
| `/tasks/:id/claim` | POST | èªé ˜ä»»å‹™ | ğŸ”´ High |
| `/tasks/:id/unclaim` | POST | å–æ¶ˆèªé ˜ | ğŸŸ¡ Medium |
| `/tasks/:id/pause` | POST | æš«åœä»»å‹™ | ğŸŸ¡ Medium |
| `/tasks/:id/resume` | POST | æ¢å¾©ä»»å‹™ | ğŸŸ¡ Medium |

---

## é™„éŒ„ Aï¼šåƒè€ƒæ–‡ä»¶

- [å°ˆæ¡ˆå¯©è¨ˆå ±å‘Š](../PROJECT_AUDIT_REPORT_20260205.md)
- [Git æ¸…ç†å ±å‘Š](../GIT_CLEANUP_SUMMARY.md)
- [ç¾æœ‰å¾Œç«¯åƒè€ƒ](../../backend/)
- [å‰ç«¯å…±ç”¨é¡å‹](../../packages/shared/types/)

---

## é™„éŒ„ Bï¼šé–‹ç™¼åŸå‰‡

### TDD æµç¨‹

1. **RED** - å…ˆå¯«æ¸¬è©¦ï¼Œçœ‹å®ƒå¤±æ•—
2. **GREEN** - å¯«æœ€å°‘çš„ç¨‹å¼ç¢¼è®“æ¸¬è©¦é€šé
3. **REFACTOR** - é‡æ§‹ç¨‹å¼ç¢¼ï¼Œä¿æŒæ¸¬è©¦é€šé

### å¢é‡éƒ¨ç½²

- æ¯å€‹ Phase å®Œæˆå¾Œç«‹å³éƒ¨ç½²
- æ¯æ¬¡åªæ¨é€ä¸€å€‹åŠŸèƒ½æ¨¡çµ„
- éƒ¨ç½²å•é¡Œå¯å¿«é€Ÿå®šä½

### ç¨‹å¼ç¢¼å“è³ª

- æ‰€æœ‰ç¨‹å¼ç¢¼å¿…é ˆé€šé TypeScript åš´æ ¼æ¨¡å¼
- æ¸¬è©¦è¦†è“‹ç‡ > 80%
- éµå¾ªç¾æœ‰ç¨‹å¼ç¢¼é¢¨æ ¼

---

*æ–‡ä»¶ç”¢ç”Ÿæ—¥æœŸ: 2026-02-06*
*ä½¿ç”¨ Superpowers Brainstorming Skill å®Œæˆ*
