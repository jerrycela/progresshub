import type { Task, PoolTask, TaskNote } from 'shared/types'
import { getUserRef } from './employees'
import { getProjectRef } from './projects'

// ============================================
// 任務池任務（15 個任務，統一 task-* ID）
// task-1~6 來自 taskPool，task-7~15 來自 data.ts
// ============================================
export const mockPoolTasks: PoolTask[] = [
  // === taskPool 原有任務 ===
  {
    id: 'task-1',
    projectId: 'proj-1',
    title: '設計主角立繪',
    description: '設計魔法王國主角的全身立繪，包含三套服裝',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['ART'],
    startDate: '2026-02-01',
    dueDate: '2026-02-15',
    createdAt: '2026-01-28',
    updatedAt: '2026-01-28',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-6', name: '黃美玲', userRole: 'PM' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-2',
    projectId: 'proj-1',
    title: 'UI 介面設計',
    description: '設計遊戲主選單和背包介面',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['ART'],
    startDate: '2026-02-05',
    dueDate: '2026-02-20',
    createdAt: '2026-01-29',
    updatedAt: '2026-01-29',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-7', name: '吳建國', userRole: 'PRODUCER' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-3',
    projectId: 'proj-2',
    title: '戰鬥系統開發',
    description: '開發太空戰鬥的核心邏輯',
    sourceType: 'POOL',
    status: 'IN_PROGRESS',
    progress: 25,
    functionTags: ['PROGRAMMING'],
    assigneeId: 'emp-4',
    assignee: getUserRef('emp-4'),
    startDate: '2026-02-01',
    dueDate: '2026-03-15',
    createdAt: '2026-01-20',
    updatedAt: '2026-02-03',
    project: getProjectRef('proj-2'),
    createdBy: { id: 'emp-5', name: '李小龍', userRole: 'MANAGER' },
    department: 'PROGRAMMING',
    canEdit: true,
    canDelete: true,
    collaboratorNames: ['李小龍'],
    gitlabIssue: {
      id: 123,
      title: '實作戰鬥系統核心邏輯',
      url: 'https://gitlab.com/star-battleship/game/issues/123',
      state: 'opened',
    },
  },
  {
    id: 'task-4',
    projectId: 'proj-1',
    title: '音效製作 - 戰鬥場景',
    description: '製作戰鬥場景的背景音樂和音效',
    sourceType: 'ASSIGNED',
    status: 'IN_PROGRESS',
    progress: 60,
    functionTags: ['SOUND'],
    assigneeId: 'emp-1',
    assignee: getUserRef('emp-1'),
    startDate: '2026-02-10',
    dueDate: '2026-02-28',
    createdAt: '2026-02-01',
    updatedAt: '2026-02-04',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-3', name: '張大華', userRole: 'MANAGER' },
    department: 'ART',
    canEdit: false,
    canDelete: false,
    gitlabIssue: {
      id: 456,
      title: '戰鬥場景音效與背景音樂',
      url: 'https://gitlab.com/magic-kingdom/game/issues/456',
      state: 'opened',
    },
  },
  {
    id: 'task-5',
    projectId: 'proj-3',
    title: '賽車模型建模',
    description: '建立 10 款賽車的 3D 模型',
    sourceType: 'SELF_CREATED',
    status: 'IN_PROGRESS',
    progress: 80,
    functionTags: ['ART'],
    assigneeId: 'emp-2',
    assignee: getUserRef('emp-2'),
    startDate: '2026-01-15',
    dueDate: '2026-02-15',
    createdAt: '2026-01-15',
    updatedAt: '2026-02-03',
    project: getProjectRef('proj-3'),
    createdBy: { id: 'emp-2', name: '林小美', userRole: 'EMPLOYEE' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-6',
    projectId: 'proj-1',
    title: '測試關卡一',
    description: '測試第一關卡的所有功能',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['PLANNING'],
    startDate: '2026-02-15',
    dueDate: '2026-02-25',
    dependsOnTaskIds: ['task-3'],
    createdAt: '2026-02-01',
    updatedAt: '2026-02-01',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-6', name: '黃美玲', userRole: 'PM' },
    department: 'QA',
    canEdit: true,
    canDelete: true,
  },
  // === data.ts 轉換的任務（ID 映射：'1'→task-7 ... '9'→task-15）===
  {
    id: 'task-7',
    projectId: 'proj-1',
    title: '實作新手教學流程邏輯',
    description: '根據企劃文件實作新手教學的程式邏輯',
    sourceType: 'ASSIGNED',
    status: 'IN_PROGRESS',
    progress: 65,
    functionTags: ['PROGRAMMING'],
    assigneeId: 'emp-1',
    assignee: getUserRef('emp-1'),
    startDate: '2026-02-05',
    dueDate: '2026-02-20',
    dependsOnTaskIds: ['task-14'],
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-10T00:00:00Z',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'PROGRAMMING',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-8',
    projectId: 'proj-1',
    title: '新手教學 UI 設計',
    description: '設計新手教學介面與圖示',
    sourceType: 'ASSIGNED',
    status: 'CLAIMED',
    progress: 30,
    functionTags: ['ART'],
    assigneeId: 'emp-9',
    assignee: getUserRef('emp-9'),
    startDate: '2026-02-10',
    dueDate: '2026-02-25',
    dependsOnTaskIds: ['task-14', 'task-7'],
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-10T00:00:00Z',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-9',
    projectId: 'proj-2',
    title: 'PVP 匹配系統開發',
    description: '開發玩家配對演算法與後端 API',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['PROGRAMMING'],
    startDate: '2026-02-15',
    dueDate: '2026-03-15',
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-01T00:00:00Z',
    project: getProjectRef('proj-2'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'PROGRAMMING',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-10',
    projectId: 'proj-2',
    title: 'PVP 戰鬥特效製作',
    description: '製作 PVP 模式專屬技能特效',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['VFX', 'ART'],
    startDate: '2026-02-20',
    dueDate: '2026-03-20',
    dependsOnTaskIds: ['task-9'],
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-01T00:00:00Z',
    project: getProjectRef('proj-2'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-11',
    projectId: 'proj-3',
    title: '主選單 UI 重新設計',
    description: '重新設計主選單介面',
    sourceType: 'ASSIGNED',
    status: 'DONE',
    progress: 100,
    functionTags: ['ART'],
    assigneeId: 'emp-9',
    assignee: getUserRef('emp-9'),
    startDate: '2026-02-15',
    dueDate: '2026-02-28',
    createdAt: '2026-02-15T00:00:00Z',
    updatedAt: '2026-02-25T00:00:00Z',
    project: getProjectRef('proj-3'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-12',
    projectId: 'proj-3',
    title: '角色動畫優化',
    description: '優化角色移動與攻擊動畫',
    sourceType: 'ASSIGNED',
    status: 'IN_PROGRESS',
    progress: 45,
    functionTags: ['ANIMATION'],
    assigneeId: 'emp-11',
    assignee: getUserRef('emp-11'),
    startDate: '2026-02-20',
    dueDate: '2026-03-10',
    createdAt: '2026-02-20T00:00:00Z',
    updatedAt: '2026-03-01T00:00:00Z',
    project: getProjectRef('proj-3'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'ART',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-13',
    projectId: 'proj-2',
    title: '背景音樂製作',
    description: '製作 PVP 戰鬥場景背景音樂',
    sourceType: 'POOL',
    status: 'UNCLAIMED',
    progress: 0,
    functionTags: ['SOUND'],
    startDate: '2026-03-01',
    dueDate: '2026-03-25',
    dependsOnTaskIds: ['task-9'],
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-01T00:00:00Z',
    project: getProjectRef('proj-2'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'SOUND',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-14',
    projectId: 'proj-1',
    title: '新手教學企劃文件',
    description: '撰寫新手教學流程與文案',
    sourceType: 'ASSIGNED',
    status: 'DONE',
    progress: 100,
    functionTags: ['PLANNING'],
    assigneeId: 'emp-10',
    assignee: getUserRef('emp-10'),
    startDate: '2026-02-01',
    dueDate: '2026-02-10',
    createdAt: '2026-02-01T00:00:00Z',
    updatedAt: '2026-02-08T00:00:00Z',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'PLANNING',
    canEdit: true,
    canDelete: true,
  },
  {
    id: 'task-15',
    projectId: 'proj-1',
    title: 'API 串接 - 用戶系統',
    description: '串接後端用戶登入與註冊 API',
    sourceType: 'ASSIGNED',
    status: 'PAUSED',
    progress: 40,
    functionTags: ['PROGRAMMING'],
    assigneeId: 'emp-1',
    assignee: getUserRef('emp-1'),
    startDate: '2026-02-15',
    dueDate: '2026-03-05',
    pauseReason: 'WAITING_TASK',
    pauseNote: '等待後端 API 完成，預計下週可繼續',
    pausedAt: '2026-02-28T10:00:00Z',
    createdAt: '2026-02-15T00:00:00Z',
    updatedAt: '2026-02-28T10:00:00Z',
    project: getProjectRef('proj-1'),
    createdBy: { id: 'emp-10', name: '張大偉', userRole: 'PM' },
    department: 'PROGRAMMING',
    canEdit: true,
    canDelete: true,
  },
]

// ============================================
// 純 Task 檢視（供 stores/tasks.ts 使用）
// ============================================
export const mockTasks: Task[] = mockPoolTasks.map(
  ({
    sourceType: _s,
    createdBy: _cb,
    department: _d,
    canEdit: _ce,
    canDelete: _cd,
    collaboratorNames: _cn,
    gitlabIssue: _gi,
    ...task
  }) => task as Task,
)

// ============================================
// 任務註記
// ============================================
export const mockTaskNotes: TaskNote[] = [
  {
    id: 'note-1',
    taskId: 'task-3',
    content: '請注意這個功能需要和後端 API 同步，建議先確認 API 規格',
    authorId: 'emp-5',
    authorName: '李小龍',
    authorRole: 'MANAGER',
    createdAt: '2026-02-03T10:00:00Z',
  },
  {
    id: 'note-2',
    taskId: 'task-3',
    content: '已與後端確認 API 規格，可以開始實作',
    authorId: 'emp-6',
    authorName: '黃美玲',
    authorRole: 'PM',
    createdAt: '2026-02-03T14:30:00Z',
  },
  {
    id: 'note-3',
    taskId: 'task-4',
    content: '音效風格請參考魔法王國世界觀設定文件',
    authorId: 'emp-7',
    authorName: '吳建國',
    authorRole: 'PRODUCER',
    createdAt: '2026-02-01T09:00:00Z',
  },
]
